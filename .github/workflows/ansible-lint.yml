---

name: Ansible Lint

on:
  # Runs at 10:10 on every Monday
  schedule:
    - cron: '10 10 * * 1'

  # Validate open pull requests
  pull_request:
    branches:
      - stage
      - dev

  # Runs on push to dev and main branches
  push:
    branches:
      - dev
      - main

  # Enable manual start button
  workflow_dispatch:

jobs:
  ansible-lint:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v5

        # Use @v25 to automatically track the latest release from the year 2025.
        # ansible-lint uses Calendar Versioning (e.g., v25.9.0 -> YYYY.MM.PATCH).
        # Avoid using @main, which can introduce breaking changes unexpectedly.
      - uses: ansible/ansible-lint@v25
        with:
          # Use the shared requirements file from the collection root for dependency context.
          requirements_file: ./common_fragments/ansible_requirements.yml
